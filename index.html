<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TX VIP PRO – LC79</title>
  <style>
    :root{
      --bg:#0b1220; --card:#0f172a; --neon:#22d3ee; --ok:#22c55e; --bad:#ef4444; --muted:#94a3b8;
    }
    *{box-sizing:border-box;font-family:system-ui,-apple-system,Segoe UI,Roboto}
    body{margin:0;min-height:100vh;background:radial-gradient(1200px 600px at 10% -10%,#0b2a3a,transparent),var(--bg);color:#e5e7eb;display:grid;place-items:center}
    .wrap{width:min(420px,92vw)}
    .card{background:linear-gradient(180deg,#0b1328,#0a1020);border:1px solid #0b2440;border-radius:18px;box-shadow:0 0 0 1px #0b2440 inset,0 20px 60px rgba(0,0,0,.5);padding:16px}
    .title{display:flex;align-items:center;gap:10px;margin-bottom:10px}
    .dot{width:8px;height:8px;border-radius:50%;background:var(--neon);box-shadow:0 0 12px var(--neon)}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .box{background:#0b1328;border:1px solid #0b2440;border-radius:14px;padding:10px}
    .big{font-size:28px;font-weight:800;letter-spacing:.5px}
    .tx{font-size:36px;font-weight:900}
    .tai{color:var(--ok)} .xiu{color:var(--bad)}
    .muted{color:var(--muted)}
    .bar{height:8px;border-radius:999px;background:#0b2440;overflow:hidden}
    .fill{height:100%;background:linear-gradient(90deg,#22d3ee,#60a5fa);width:0%}
    .row{display:flex;justify-content:space-between;gap:8px}
    .pill{padding:6px 10px;border-radius:999px;border:1px solid #0b2440;background:#0b1328}
    .btns{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px}
    .btn{border-radius:12px;border:1px solid #0b2440;background:#0b1328;color:#e5e7eb;padding:10px;font-weight:700}
    .btn.ok{outline:2px solid rgba(34,197,94,.2)}
    .btn.no{outline:2px solid rgba(239,68,68,.2)}
    .foot{margin-top:10px;display:flex;justify-content:space-between;align-items:center}
    .spin{width:14px;height:14px;border:2px solid #0b2440;border-top-color:var(--neon);border-radius:50%;animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="title">
        <div class="dot"></div>
        <strong>TX VIP PRO – LC79</strong>
        <span class="muted" id="apiState">• checking…</span>
      </div>

      <div class="grid">
        <div class="box">
          <div class="muted">Phiên</div>
          <div class="big" id="phien">—</div>
        </div>
        <div class="box">
          <div class="muted">Xúc xắc</div>
          <div class="big" id="dice">—</div>
        </div>
        <div class="box">
          <div class="muted">Tổng</div>
          <div class="big" id="sum">—</div>
        </div>
        <div class="box">
          <div class="muted">Kết quả</div>
          <div class="tx" id="tx">—</div>
        </div>
      </div>

      <div class="box" style="margin-top:10px">
        <div class="row">
          <strong>AI tổng hợp</strong>
          <span class="pill" id="aiPick">—</span>
        </div>
        <div class="bar" style="margin:8px 0"><div class="fill" id="aiBar"></div></div>
        <div class="row muted">
          <span>Độ tin cậy</span>
          <span id="aiPct">0%</span>
        </div>
      </div>

      <div class="btns">
        <button class="btn ok" id="btnFollow">THEO</button>
        <button class="btn no" id="btnNoFollow">KHÔNG THEO</button>
      </div>

      <div class="foot">
        <span class="muted" id="lastUpdate">—</span>
        <div class="spin" id="loading"></div>
      </div>
    </div>
  </div>

<script>
const API = "https://lc79-byck.onrender.com/lc79/md5";
let history = [];
let lastPhien = null;

const $ = id => document.getElementById(id);
const txOf = sum => sum >= 11 ? "TÀI" : "XỈU";

function engineBet(h){ if(h.length>=3 && h.at(-1)===h.at(-2) && h.at(-2)===h.at(-3)) return h.at(-1); }
function engineFlip(h){ if(h.length>=1) return h.at(-1)==="TÀI"?"XỈU":"TÀI"; }
function engineFreq(h){
  const m = {}; h.slice(-10).forEach(x=>m[x]=(m[x]||0)+1);
  let best=null, c=0; for(const k in m){ if(m[k]>c){c=m[k]; best=k;} } return best;
}

async function load(){
  $("loading").style.display="inline-block";
  try{
    const res = await fetch(API, {cache:"no-store"});
    const d = await res.json();
    $("apiState").textContent = "• online";
    $("apiState").style.color = "#22c55e";

    const sum = d.xuc_xac_1 + d.xuc_xac_2 + d.xuc_xac_3;
    const tx = txOf(sum);

    if(d.phien !== lastPhien){
      history.push(tx);
      lastPhien = d.phien;
    }

    const e1 = engineBet(history);
    const e2 = engineFlip(history);
    const e3 = engineFreq(history);
    const arr = [e1,e2,e3].filter(Boolean);
    const cnt = arr.reduce((a,x)=>(a[x]=(a[x]||0)+1,a),{});
    let pick = null, pct = 0;
    if(arr.length){
      pick = Object.entries(cnt).sort((a,b)=>b[1]-a[1])[0][0];
      pct = Math.round((cnt[pick]/3)*100);
    }

    $("phien").textContent = d.phien ?? "—";
    $("dice").textContent = `${d.xuc_xac_1}-${d.xuc_xac_2}-${d.xuc_xac_3}`;
    $("sum").textContent = sum;
    $("tx").textContent = tx;
    $("tx").className = "tx " + (tx==="TÀI"?"tai":"xiu");

    $("aiPick").textContent = pick ? pick : "—";
    $("aiPct").textContent = pct + "%";
    $("aiBar").style.width = pct + "%";

    $("lastUpdate").textContent = "Cập nhật: " + new Date().toLocaleTimeString();
  }catch(e){
    $("apiState").textContent = "• offline";
    $("apiState").style.color = "#ef4444";
  }finally{
    $("loading").style.display="none";
  }
}

$("btnFollow").onclick = ()=> alert("THEO khi AI ≥ 70% nhé!");
$("btnNoFollow").onclick = ()=> alert("KHÔNG THEO khi AI < 70%");

load();
setInterval(load, 3000);
</script>
</body>
</html>
